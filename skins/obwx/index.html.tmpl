#errorCatcher Echo
#import random
<!DOCTYPE html>
<html lang='en'>
    <head>
        <title>$Extras.html_title</title>

        <link rel='manifest' href='manifest.json'>
        <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css' integrity='sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi' crossorigin='anonymous'>
        <link rel='stylesheet' type='text/css' href='obwx.css?v=#echo int(random.random()*123456789)#'>
        <script src='https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js' integrity='sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk' crossorigin='anonymous'></script>
        <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js'></script>
        <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.1.0/paho-mqtt.min.js'></script>
        <script type='text/javascript' src='obwx.js?v=#echo int(random.random()*123456789)#'></script> 

        <meta name='viewport' content='width=device-width, initial-scale=1'>

        <script type='text/javascript'>
            const mqttclient = 'obwx' + Math.floor(Math.random() * 123456789);

            // Disable AJAX caching
            jQuery.ajaxSetup( {cache: false} );

            // Initalize the app after DOM loaded
            jQuery(document).ready(function() {
                drawCompassRose();
                drawCompassArrow();
                updateArcCast()
                mqttconnect()
            });

        </script>
    </head>
    <body>
        <main>
            <div class='row g-0 text-center'>
                <!--SiteLogo-->
                <div class='col-12 col-lg-3'>
                    <div class='logo'>
                        #if $Extras.has_key("logo_img") and $Extras.logo_img != ''
                        <img src='$Extras.logo_img' title='$Extras.logo_title' alt='$Extras.logo_alt'>
                        #else
                        <div>$html_title</div>
                        #end if
                    </div>
                </div>
                <!-- Alerts -->
                <div class='col-12 col-lg-6'>
                    <div class='weather-alerts'></div>
                </div>
                <!-- Datetime -->
                <div class='col-12 col-lg-3'>
                    <div class='updated-date float-lg-none'>---</div>
                    <div class='updated-time float-lg-none'>---</div>
                </div>
                <!-- Current Wx -->
                <div class='col-12 col-lg-4' style='border: 1px dashed fuchsia;'>
                    <div class='row g-0'>
                        <!-- Weather -->
                        <div class='col-6'>
                            <div class='current-wx-icon'>---</div>                             
                            <div class='current-wx-text'>-----</div>
                        </div>
                        <!-- Temps -->
                        <div class='col-6'>
                            <div class='current-outTemp'>
                                <span class='outTemp'>--.-<sup>&deg;</sup></span>
                            </div>
                            <div class='feels-like'>--</div>
                            <div class='dewpoint'>---</div>
                            <div class='outHumidity'>---</div>
                            <div>
                                <span class='barometer'>---</span>
                                <span class='barometer-trend'>--</span>
                            </div>
                            <div class='uv'>---</div>
                        </div>
                    </div>
                </div>
                <!-- Wind Direction -->
                <div class='col-6 col-lg-2'>
                    <div class='position-relative'>
                        <canvas class='rose' id='rose' width='150' height='150'></canvas>
                        <canvas class='rose-arrow' id='rose-arrow' width='150' height='150'></canvas>
                        <div class='rose-text wind-direction-deg'>--</div>
                    </div>
                </div>
                <!-- Wind Speed -->
                <div class='col-6 col-lg-2' style='border: 1px dashed blue;'>
                    <div class='position-relative'>
                        <div class='wind-meter mx-auto'></div>
                        <div class='wind-speed-mph'>---</div>
                        <div class='windometer-tickmark' style='transform: rotate(-45deg);'></div>
                        <div class='windometer-tickmark' style='transform: rotate(0deg);'></div>
                        <div class='windometer-tickmark' style='transform: rotate(45deg);'></div>
                        <div class='windometer-tickmark-recentHi' style='transform: rotate(90deg);'></div>
                        <div class='windometer-arrow'></div>
                    </div>
                    <div class='pt-4'>
                        <span class='windDir-1hrAvg'>--</span>
                        <span class='windSpd-1hrAvg'>--</span>
                    </div>
                    <div>
                        <span class='wind-1hrAvg-label'>Average Wind</span>
                    </div>
                </div>
                <!-- Rain Bucket -->
                <div class='col-6 col-lg-2 my-auto'>
                    <div class='position-relative w-100'>
                        <div class='raingauge-bucket mx-auto'> 
                            <div class='raingauge-rain'></div> 
                            <div class='raingauge-tape' style='top:0%'></div> 
                            <div class='raingauge-tape' style='top:25%'></div> 
                            <div class='raingauge-tape' style='top:50%'></div> 
                            <div class='raingauge-tape' style='top:75%'></div> 
                            <div class='raingauge-text raingauge-dayRain'>--</div> 
                        </div>
                    </div> 
                    <div class='pt-3 rainrate'>---</div> 
                </div>
                <!-- Rain Records -->
                <div class='col-6 col-lg-2 pb-4 my-auto'>
                    <div class='row g-0 rain-records'>
                        <div class='col'>
                            <div class='rain-title'>Yesterday</div>
                            <div class='rain-title'>Week</div>
                            <div class='rain-title'>Month</div>
                            <div class='rain-title'>Year</div>
                        </div>
                        <div class='col'>
                            <div class='rain-value yesterday-rain'>---</div> 
                            <div class='rain-value week-rain'>---</div> 
                            <div class='rain-value month-rain'>---</div> 
                            <div class='rain-value year-rain'>---</div> 
                        </div>
                    </div>
                </div>
                <!-- Temp Records -->
                <div class='col-6 col-lg-2' style="border: 1px dashed darkred;">
                    <div class="records mx-auto">
                        <div class="records-title">Today's High</div>
                        <div class="records-icon records-high">I</div>
                        <div class="outTemp-max">--</div>
                        <div class="records-time outTemp-max-time">--</div>
                    </div>
                </div>
                <!-- Other Records -->
                <div class='col-6 col-lg-2'>
                    <div class="records mx-auto">
                        <div class="records-title">Today's Low</div>
                        <div class="records-icon records-low">I</div>
                        <div class="outTemp-min">--</div>
                        <div class="records-time outTemp-min-time">--</div>
                    </div>
                </div>
                <!-- Metar -->
                <div class='col-6 col-lg-4' style='border: 1px dashed yellow;'>
                    <div class="row g-0">
                        <div class="col-3">
                            <div class="metar-location">--</div>
                            <div class="metar-oat">--</div>
                            <canvas id="metar" height="76" width="76" class="d-block mx-auto"></canvas>
                        </div>
                        <div class="col-4">
                            <div class="metar-updated">--</div>
                            <div class="metar-vis">--</div>
                            <div class="d-flex justify-content-evenly">
                                <div class="metar-wind-direction">--</div>
                                <div class="metar-wind-direction-deg">---</div>
                            </div>
                            <div class="metar-wind-speed-kts">--</div>
                            <div class="metar-rules">--</div>
                        </div>
                        <div class="col-5">
                            <div class="metar-weather">--</div>
                            <div class="metar-cloud-layer">--</div>
                        </div>
                    </div>
                </div>
                <!-- Almanac -->
                <div class='col-12 col-lg-4' style='border: 1px dashed cyan;'>
                    <div class='row g-0'>
                        <div class='col'></div>
                        <div class='pt-4 alm-outer-left'>
                            <div class='sunrise'>
                                <div class='sunrise-title'>Sunrise</div>
                                <div class='sunrise-time'>--</div>
                            </div>
                            <div class='moonrise'>
                                <div class='moonrise-time'>--</div>
                                <div class='moonrise-title'>MoonRise</div>
                            </div>
                        </div>
                        <div class='alm-inner'>
                            <div class='daylight'>
                                <span class='daylight-label'>Daylight: </span>
                                <span class='daylight-time'></span>
                            </div>
                            <div style="border: 0px dashed chocolate;">
                                <canvas id="arcs" height="160" width="160"></canvas>
                            </div>
                            <div class='phase'>First Quarter</div>
                        </div>
                        <div class='pt-4 alm-outer-right'>
                            <div class='sunset'>
                                <div class='sunset-title'>Sunset</div>
                                <div class='sunset-time'>--</div>
                            </div>
                            <div class='moonset'>
                                <div class='moonset-time'>--</div>
                                <div class='moonset-title'>MoonSet</div>
                            </div>
                        </div>
                        <div class='col'></div>
                    </div>
                </div>
                <!-- Forecast 0 -->
                <div class='col-6 col-lg-2'>
                    <div class="forecast-p0-date">--</div>
                    <div class="row g-0">
                        <div class="col-4">
                            <div class="forecast-p0-icon"></div>
                        </div>
                        <div class="col">
                            <div>
                                <span class="forecast-p0-hilo-txt"></span>
                                <span class="forecast-p0-hilo-temp"></span>
                            </div>
                            <div>
                                <span class="forecast-p0-pop"></span>
                                <img src="icons/raindrop.png">
                                <span class="forecast-p0-precip"></span>
                            </div>
                        </div>
                    </div>
                    <div class="forecast-p0-wxPriCode"></div>
                    <div>
                        <span class="forecast-p0-windDir"></span>
                        <img src="icons/windicon.png">
                        <span class="forecast-p0-windSpd"></span>
                    </div>
                </div>
                <!-- Forecast 1 -->
                <div class='col-6 col-lg-2' style='border: 1px dashed green;'>
                    <div class="forecast-p1-date">--</div>
                    <div class="row g-0">
                        <div class="col-4">
                            <div class="forecast-p1-icon"></div>
                        </div>
                        <div class="col">
                            <div>
                                <span class="forecast-p1-hilo-txt"></span>
                                <span class="forecast-p1-hilo-temp"></span>
                            </div>
                            <div>
                                <span class="forecast-p1-pop"></span>
                                <img src="icons/raindrop.png">
                                <span class="forecast-p1-precip"></span>
                            </div>
                        </div>
                    </div>
                    <div class="forecast-p1-wxPriCode"></div>
                    <div>
                        <span class="forecast-p1-windDir"></span>
                        <img src="icons/windicon.png">
                        <span class="forecast-p1-windSpd"></span>
                    </div>
                </div>
                <!-- Forecast 2 -->
                <div class='col-6 col-lg-2'>
                    <div class="forecast-p2-date">--</div>
                    <div class="row g-0">
                        <div class="col-4">
                            <div class="forecast-p2-icon"></div>
                        </div>
                        <div class="col">
                            <div>
                                <span class="forecast-p2-hilo-txt"></span>
                                <span class="forecast-p2-hilo-temp"></span>
                            </div>
                            <div>
                                <span class="forecast-p2-pop"></span>
                                <img src="icons/raindrop.png">
                                <span class="forecast-p2-precip"></span>
                            </div>
                        </div>
                    </div>
                    <div class="forecast-p2-wxPriCode"></div>
                    <div>
                        <span class="forecast-p2-windDir"></span>
                        <img src="icons/windicon.png">
                        <span class="forecast-p2-windSpd"></span>
                    </div>
                </div>
                <!-- Forecast 3 -->
                <div class='col-6 col-lg-2'>
                    <div class="forecast-p3-date">--</div>
                    <div class="row g-0">
                        <div class="col-4">
                            <div class="forecast-p3-icon"></div>
                        </div>
                        <div class="col">
                            <div>
                                <span class="forecast-p3-hilo-txt"></span>
                                <span class="forecast-p3-hilo-temp"></span>
                            </div>
                            <div>
                                <span class="forecast-p3-pop"></span>
                                <img src="icons/raindrop.png">
                                <span class="forecast-p3-precip"></span>
                            </div>
                        </div>
                    </div>
                    <div class="forecast-p3-wxPriCode"></div>
                    <div>
                        <span class="forecast-p3-windDir"></span>
                        <img src="icons/windicon.png">
                        <span class="forecast-p3-windSpd"></span>
                    </div>
                </div>
                <!-- Forecast 4 -->
                <div class='col-6 col-lg-2'>
                    <div class="forecast-p4-date">--</div>
                    <div class="row g-0">
                        <div class="col-4">
                            <div class="forecast-p4-icon"></div>
                        </div>
                        <div class="col">
                            <div>
                                <span class="forecast-p4-hilo-txt"></span>
                                <span class="forecast-p4-hilo-temp"></span>
                            </div>
                            <div>
                                <span class="forecast-p4-pop"></span>
                                <img src="icons/raindrop.png">
                                <span class="forecast-p4-precip"></span>
                            </div>
                        </div>
                    </div>
                    <div class="forecast-p4-wxPriCode"></div>
                    <div>
                        <span class="forecast-p4-windDir"></span>
                        <img src="icons/windicon.png">
                        <span class="forecast-p4-windSpd"></span>
                    </div>
                </div>
                <!-- Forecast 5 -->
                <div class='col-6 col-lg-2'>
                    <div class="forecast-p5-date">--</div>
                    <div class="row g-0">
                        <div class="col-4">
                            <div class="forecast-p5-icon"></div>
                        </div>
                        <div class="col">
                            <div>
                                <span class="forecast-p5-hilo-txt"></span>
                                <span class="forecast-p5-hilo-temp"></span>
                            </div>
                            <div>
                                <span class="forecast-p5-pop"></span>
                                <img src="icons/raindrop.png">
                                <span class="forecast-p5-precip"></span>
                            </div>
                        </div>
                    </div>
                    <div class="forecast-p5-wxPriCode"></div>
                    <div>
                        <span class="forecast-p5-windDir"></span>
                        <img src="icons/windicon.png">
                        <span class="forecast-p5-windSpd"></span>
                    </div>
                </div>
            </div>
        </main>
    </body>
</html>
